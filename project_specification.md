# プロジェクト仕様書: クイズアプリケーション（MyQuest）

## 1. 概要

**MyQuest**は、Python公式チュートリアルに基づいたクイズを通じて、ユーザーがPythonの知識を学習・確認するためのWebアプリケーションです。利用者は章ごとのテストや、間違えた問題に特化した復習機能を通じて、効率的に学習を進めることができます。

## 2. 主な機能

### 2.1. ユーザー認証
- **サインアップ**: 新規ユーザー登録
- **ログイン/ログアウト**: 登録済みユーザーの認証管理
- **パスワード変更**: ユーザーが自身のパスワードを変更する機能

### 2.2. クイズ機能
ユーザーは複数のモードでクイズに挑戦できます。

1.  **セクション別テスト (`/section_test`)**
    - ユーザーは特定の章（カテゴリ）を選択し、その範囲の問題に挑戦します。
    - 解答後、正誤判定とスコアが表示されます。

2.  **練習モード (`/practice`)**
    - 全ての章からランダムに選ばれた問題が出題されます。

3.  **苦手問題の復習 (`/practice_incorrect`)**
    - 過去2回の挑戦で少なくとも1回間違えた問題に絞って出題されます。
    - ユーザーが苦手な部分を重点的に学習するための機能です。

### 2.3. 結果の追跡
- 全てのクイズ解答履歴はデータベースに保存されます。
- この履歴は、スコア計算や苦手問題の特定に利用されます。

### 2.4. 管理画面 (`/admin`)
- 将来的なコンテンツ管理（問題の追加・編集など）を想定した管理者用ページです。
- 現状では基本的なテンプレートのみで、具体的な機能は実装されていません。

## 3. 技術スタック

- **バックエンド**: Python, Flask
- **データベース**: SQLite
- **ORM**: Flask-SQLAlchemy
- **フロントエンド**: HTML, Bootstrap 5
- **データソース**: `questions.json`

## 4. データベース設計 (データモデル)

データベースは3つのテーブルで構成されます。

| テーブル名 | 説明 | 主なカラム |
| :--- | :--- | :--- |
| `users` | ユーザー情報を管理 | `id`, `username`, `password_hash` |
| `questions` | クイズの問題と解答を管理 | `id`, `category`, `question_text`, `choices`, `answer`, `explanation` |
| `quiz_results` | ユーザーごとの解答履歴を管理 | `id`, `user_id` (FK), `question_id` (FK), `is_correct`, `timestamp` |

- **リレーション**:
    - `quiz_results.user_id` は `users.id` に紐づきます。
    - `quiz_results.question_id` は `questions.id` に紐づきます。

## 5. プロジェクトのセットアップと実行

### 5.1. データベースの初期化とコンテンツの投入
1.  **ユーザー作成**:
    ```bash
    python create_users.py
    ```
    - スクリプトの指示に従い、管理者ユーザーを作成します。

2.  **問題のインポート**:
    ```bash
    python import_questions.py
    ```
    - `questions.json` ファイルからクイズの問題をデータベースにインポートします。

### 5.2. アプリケーションの起動
以下のコマンドで開発サーバーを起動します。

```bash
flask run
# または
python app.py
```
起動後、Webブラウザで `http://127.0.0.1:5000` にアクセスします。

## 6. 主要なファイル構成

- `app.py`: Flaskアプリケーション本体。ルーティング、ビュー関数、主要ロジックを定義。
- `model.py`: SQLAlchemyを使ったデータベースモデル（テーブルスキーマ）を定義。
- `database.py`: データベースインスタンスのセットアップ。
- `questions.json`: クイズの問題、選択肢、解答が格納されたJSONファイル。
- `import_questions.py`: `questions.json` を読み込み、データベースに登録するスクリプト。
- `create_users.py`: ユーザーを新規作成するためのスクリプト。
- `templates/`: HTMLテンプレート群。
- `instance/quiz.db`: SQLiteデータベースファイル。
